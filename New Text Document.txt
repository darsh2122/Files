import java.sql.*;
import java.util.ArrayList;
import java.util.List;

public class MyDatabase {
  private Connection connection;
  
  public MyDatabase() {
    // initialize database connection
    try {
      Class.forName("com.mysql.jdbc.Driver");
      String url = "jdbc:mysql://localhost/mydatabase";
      String username = "myusername";
      String password = "mypassword";
      connection = DriverManager.getConnection(url, username, password);
    } catch (ClassNotFoundException e) {
      e.printStackTrace();
    } catch (SQLException e) {
      e.printStackTrace();
    }
  }
  
  public List<String> getVariablesForValue(String variableValue) {
    List<String> variables = new ArrayList<String>();
    try {
      PreparedStatement statement = connection.prepareStatement("SELECT variable_name FROM my_table WHERE variable_value = ?");
      statement.setString(1, variableValue);
      ResultSet resultSet = statement.executeQuery();
      while (resultSet.next()) {
        variables.add(resultSet.getString("variable_name"));
      }
    } catch (SQLException e) {
      e.printStackTrace();
    }
    return variables;
  }
  
  public boolean checkValuesForVariable(String variableValue, List<String> variableNames) {
    List<String> variablesInTable = getVariablesForValue(variableValue);
    for (String variableName : variableNames) {
      if (!variablesInTable.contains(variableName)) {
        return false;
      }
    }
    return true;
  }
}
